<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Machine</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap');
        
        :root { 
            --j-blue: #ffffff; 
            --j-glow: rgba(255, 255, 255, 0.1); 
            --bg: #050505; 
            --gold: #ff0000; 
            --panel: rgba(5, 5, 5, 0.95);
        }

        body { 
            background: var(--bg); 
            color: var(--j-blue); 
            font-family: 'Rajdhani', sans-serif; 
            margin: 0; 
            overflow: hidden; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
            touch-action: manipulation;
        }

        body::after {
            content: " ";
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.02), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.02));
            z-index: 20;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            opacity: 0.3;
        }

        .hud-frame { 
            position: relative; 
            width: 95vw; 
            max-width: 850px; 
            height: 90vh; 
            background: var(--panel); 
            border: 1px solid #333; 
            box-shadow: 0 0 40px rgba(0,0,0,1), inset 0 0 20px var(--j-glow); 
            padding: 40px; 
            overflow-y: auto; 
            z-index: 10;
            clip-path: polygon(0 40px, 40px 0, calc(100% - 40px) 0, 100% 40px, 100% calc(100% - 40px), calc(100% - 40px) 100%, 40px 100%, 0 calc(100% - 40px));
        }

        .core-container { display: flex; justify-content: center; align-items: center; margin: 20px 0; position: relative; cursor: pointer; height: 120px; }
        .core-ring { position: absolute; border: 2px solid var(--j-blue); border-radius: 50%; opacity: 0.6; }
        .ring-1 { width: 100px; height: 100px; border-style: dashed; animation: rotate 10s linear infinite; }
        .ring-2 { width: 80px; height: 80px; border-width: 3px; border-top-color: var(--gold); animation: rotate-rev 5s linear infinite; }
        .ring-3 { width: 40px; height: 40px; background: radial-gradient(var(--gold), transparent); animation: pulse 2s infinite; }

        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes rotate-rev { from { transform: rotate(360deg); } to { transform: rotate(0deg); } }
        @keyframes pulse { 0%, 100% { opacity: 0.4; transform: scale(0.9); } 50% { opacity: 1; transform: scale(1.1); } }

        h1 { font-family: 'Orbitron'; letter-spacing: 10px; text-align: center; text-transform: uppercase; margin: 10px 0; }
        input, select { background: rgba(255, 255, 255, 0.05); border: 1px solid #444; color: var(--j-blue); padding: 15px; width: 100%; margin-bottom: 15px; font-family: 'Orbitron'; outline: none; box-sizing: border-box; }
        .btn-jarvis { background: transparent; border: 1px solid var(--j-blue); color: var(--j-blue); padding: 18px; width: 100%; cursor: pointer; font-family: 'Orbitron'; font-weight: bold; letter-spacing: 4px; transition: 0.4s; }
        .btn-jarvis:hover:not(:disabled) { background: var(--j-blue); color: #000; box-shadow: 0 0 20px var(--j-blue); }
        
        .option-node { border: 1px solid #222; padding: 18px; margin: 12px 0; cursor: pointer; transition: 0.3s; background: rgba(255,255,255,0.02); }
        .option-node.active { background: rgba(255, 0, 0, 0.1); border-left: 8px solid var(--gold); color: var(--gold); }
        
        .spec-bg { width: 100%; height: 6px; background: rgba(255,255,255,0.05); margin-bottom: 15px; overflow: hidden; }
        .spec-fill { height: 100%; background: var(--j-blue); transition: width 1.5s ease; box-shadow: 0 0 10px var(--j-blue); }
        
        .coach-box { margin-top: 25px; padding: 25px; border: 1px solid var(--gold); background: rgba(255, 0, 0, 0.05); }
        .coach-box h4 { color: var(--gold); font-family: 'Orbitron'; font-size: 0.8em; margin-bottom: 10px; border-bottom: 1px solid rgba(255,0,0,0.2); }
        
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="hud-frame">
    <div id="setup">
        <h1>M.A.C.H.I.N.E</h1>
        <h4><center>(Multimodal Assessment of Cognitive Heuristics, Information Networking, and Execution)</h4>
        
        <div class="core-container">
            <div class="core-ring ring-1"></div><div class="core-ring ring-2"></div><div class="core-ring ring-3"></div>
        </div>
        <select id="lang" onchange="updateLang()">
            <option value="en">PROTOCOL: ENGLISH</option>
            <option value="hi">प्रो़टोकॉल: हिन्दी</option>
            <option value="mr">प्रोटोकॉल: मराठी</option>
        </select>
        <input type="text" id="subjectName" placeholder="SUBJECT IDENTITY">
        <button class="btn-jarvis" onclick="calibrate()">INITIALIZE NEURAL SCAN</button>
    </div>

    <div id="calibration" class="hidden">
        <h2 style="text-align:center; font-family:'Orbitron';">SYNCING WITH CORE...</h2>
        <div class="core-container">
            <div class="core-ring ring-1"></div><div class="core-ring ring-3"></div>
        </div>
        <div style="height: 2px; background: var(--gold); width: 0%; transition: width 3s linear;" id="cal-bar"></div>
    </div>

    <div id="quiz" class="hidden">
        <div id="q-text" style="font-size: 1.1em; min-height: 80px; padding-top: 10px;"></div>
        <div id="opts"></div>
        <button id="next-btn" class="btn-jarvis" onclick="nextQ()" disabled>UPLOAD DATA</button>
    </div>

    <div id="results" class="hidden">
        <h1 id="top-type" style="color: var(--gold);"></h1>
        
        <div class="core-container" onclick="exportToExcel()" id="download-trigger">
            <div class="core-ring ring-1"></div><div class="core-ring ring-2"></div>
            <div class="core-ring ring-3" style="background: var(--gold);"></div>
            <span id="core-label" style="position:absolute; bottom:-15px; font-size:10px; letter-spacing:2px; font-family:'Orbitron';">ACCESS DATA CORE</span>
        </div>

        <div id="spectrum-bars" style="margin: 30px 0;"></div>
        <div id="coach-engine" class="coach-box"></div>
        
        <button class="btn-jarvis" onclick="copyNeuralLink()" style="margin-top:20px; border-color: var(--gold); color: var(--gold);">ESTABLISH NEURAL LINK (AI)</button>
        <button class="btn-jarvis" onclick="location.reload()" style="margin-top:10px; opacity: 0.6; font-size: 0.7em;">RE-CALIBRATE SYSTEM</button>
    </div>
</div>

<script>
// --- CLOUD SYNC CONFIGURATION ---
const DRIVE_LINK = "https://script.google.com/macros/s/AKfycbz17aqnC0qmC9W_KVFtKCUsgc4Zxc0KzAsU9aKlz-ZzfezQsJ7XYz0HTQXiRl4Ygn5B/exec"; 

const content = {
    en: { start: "System Ready. Initializing Scan.", core: "ACCESS DATA CORE", res_head: "PROFILE ANALYSIS", path: "PATHWAY", q: [
        ["You are helping someone find their way to the airport or a local station. You would most likely:", ["Draw or show them a map on paper or a screen.", "Tell them the directions verbally and answer their questions.", "Write down the directions as a list of clear steps.", "Go with them and show them the way personally."]],
        ["A website has a video showing how to create a complex graph. You learn best from:", ["Seeing the diagrams and the visual layout of the graph.", "Listening to the person in the video explain the process.", "Reading the subtitles or the written instructions provided.", "Watching the physical actions and steps being performed."]],
        ["You have an important project to complete. To ensure its success, you would prefer to:", ["Use diagrams, charts, and flowcharts to design the project structure.", "Discuss the details of the project with others to refine your ideas.", "Write a detailed report or a structured plan of action.", "Use real-life examples and case studies to demonstrate its value."]],
        ["You are cooking a special treat for your family or friends. You would likely:", ["Look at the pictures in a cookbook or online for inspiration.", "Ask your friends for suggestions and verbal tips.", "Follow a printed recipe or a written list of ingredients.", "Cook from memory or use your intuition through tasting."]],
        ["You are teaching a group of visitors about a local wildlife reserve. You would:", ["Show them maps and colorful pictures of the animals and area.", "Talk to them about the history and the animals in the park.", "Give them books, brochures, or pamphlets to read at their own pace.", "Take them on a guided walk through the reserve to see things firsthand."]],
        ["You are planning to buy a new digital camera or mobile phone. Besides the price, you look for:", ["A modern, sleek design that looks visually appealing.", "The salesperson’s advice and recommendations during the talk.", "Online reviews and reading the full technical specifications.", "Testing the device yourself to see how it feels in your hand."]],
        ["When learning something new, such as a computer program or hobby, you prefer:", ["Looking at diagrams and charts that show how it works.", "Listening to an expert explain it and asking them questions.", "Reading a written manual or a set of printed instructions.", "Watching a demonstration and then trying it out yourself."]],
        ["A doctor is explaining a heart problem to you. You would understand best if they:", ["Showed you a diagram or a drawing of the heart's structure.", "Described the issue to you in clear, spoken language.", "Gave you a pamphlet or text to read about the condition.", "Used a plastic model of the heart to show what is happening."]],
        ["You are learning to use a new computer program on your own. You would:", ["Follow the diagrams provided in the user manual.", "Talk with people who already know how to use the program.", "Read the step-by-step instructions that come with the software.", "Use trial and error by clicking on everything to see what happens."]],
        ["The websites that you find most useful and appealing usually have:", ["Strong visual design features, colors, and interesting layouts.", "Audio files, podcasts, or recorded interviews you can listen to.", "Clear written descriptions and well-organized text articles.", "Interactive elements where you can click and move things around."]],
        ["You are buying a new non-fiction book to learn something. You look for:", ["A book with many illustrations, charts, and a great layout.", "A recommendation from a friend after a long discussion.", "The chance to read snippets and sections before you buy.", "Real-life stories and practical examples of how to do things."]],
        ["You are using a book to learn how to take better photos. You want the book to have:", ["Detailed diagrams of the camera parts and light spectrums.", "A chance to discuss the techniques with other photographers.", "Clear written lists and explanations of settings and rules.", "Many examples of professional photos and how they were shot."]],
        ["You find that you learn most effectively from a teacher who chooses to use:", ["Visual aids such as charts, graphs, and slide presentations.", "Group discussions, guest speakers, and verbal explanations.", "Handouts, textbooks, and plenty of written reading material.", "Physical models, practical experiments, and hands-on activities."]]
    ]},
    hi: { start: "सिस्टम तैयार है। स्कैन प्रारंभ हो रहा है।", core: "डेटा कोर एक्सेस करें", res_head: "प्रोफ़ाइल विश्लेषण", path: "पथ", q: [
        ["आप किसी को हवाई अड्डे या स्थानीय स्टेशन का रास्ता खोजने में मदद कर रहे हैं। आप सबसे अधिक संभावना है:", ["कागज या स्क्रीन पर उन्हें मानचित्र दिखाएंगे।", "उन्हें मौखिक रूप से निर्देश देंगे और उनके प्रश्नों के उत्तर देंगे।", "स्पष्ट चरणों की सूची के रूप में निर्देश लिखेंगे।", "उनके साथ जाएंगे और उन्हें व्यक्तिगत रूप से रास्ता दिखाएंगे।"]],
        ["एक वेबसाइट पर एक वीडियो है जिसमें दिखाया गया है कि एक जटिल ग्राफ कैसे बनाया जाए। आप सबसे अच्छा सीखते हैं:", ["आरेख और ग्राफ के दृश्य लेआउट को देखकर।", "वीडियो में व्यक्ति को प्रक्रिया समझाते हुए सुनकर।", "उपशीर्षक या दिए गए लिखित निर्देशों को पढ़कर।", "की जा रही शारीरिक क्रियाओं और चरणों को देखकर।"]],
        ["आपको एक महत्वपूर्ण प्रोजेक्ट पूरा करना है। इसकी सफलता सुनिश्चित करने के लिए, आप पसंद करेंगे:", ["प्रोजेक्ट संरचना डिजाइन करने के लिए आरेख और चार्ट का उपयोग करना।", "अपने विचारों को परिष्कृत करने के लिए दूसरों के साथ प्रोजेक्ट के विवरण पर चर्चा करना।", "एक विस्तृत रिपोर्ट या कार्य की एक संरचित योजना लिखना।", "इसके मूल्य को प्रदर्शित करने के लिए वास्तविक जीवन के उदाहरणों का उपयोग करना।"]],
        ["आप अपने परिवार या दोस्तों के लिए एक विशेष दावत बना रहे हैं। आप शायद:", ["प्रेरणा के लिए कुकबुक या ऑनलाइन चित्रों को देखेंगे।", "अपने दोस्तों से सुझाव और मौखिक सुझाव मांगेंगे।", "मुद्रित नुस्खा या सामग्री की लिखित सूची का पालन करेंगे।", "याददाश्त से खाना बनाएंगे या चखने के माध्यम से अपने अंतर्ज्ञान का उपयोग करेंगे।"]],
        ["आप आगंतुकों के एक समूह को स्थानीय वन्यजीव रिजर्व के बारे में पढ़ा रहे हैं। आप:", ["उन्हें जानवरों और क्षेत्र के मानचित्र और रंगीन चित्र दिखाएंगे।", "उनसे पार्क के इतिहास और जानवरों के बारे में बात करेंगे।", "उन्हें अपनी गति से पढ़ने के लिए किताबें या ब्रोशर देंगे।", "चीजों को प्रत्यक्ष रूप से देखने के लिए उन्हें रिजर्व के माध्यम से निर्देशित सैर पर ले जाएंगे।"]],
        ["आप एक नया डिजिटल कैमरा या मोबाइल फोन खरीदने की योजना बना रहे हैं। कीमत के अलावा, आप देखते हैं:", ["एक आधुनिक डिजाइन जो दिखने में आकर्षक हो।", "बातचीत के दौरान विक्रेता की सलाह और सिफारिशें।", "ऑनलाइन समीक्षाएं और पूर्ण तकनीकी विनिर्देश पढ़ना।", "यह देखने के लिए कि यह आपके हाथ में कैसा महसूस होता है, डिवाइस का स्वयं परीक्षण करना।"]],
        ["कुछ नया सीखते समय, जैसे कंप्यूटर प्रोग्राम या शौक, आप पसंद करते हैं:", ["आरेख और चार्ट देखना जो दिखाते हैं कि यह कैसे काम करता है।", "किसी विशेषज्ञ को इसे समझाते हुए सुनना और उनसे प्रश्न पूछना।", "एक लिखित मैनुअल या मुद्रित निर्देशों का सेट पढ़ना।", "एक प्रदर्शन देखना और फिर इसे स्वयं आज़माना।"]],
        ["एक डॉक्टर आपको दिल की समस्या के बारे में समझा रहा है। आप सबसे अच्छा समझेंगे यदि वे:", ["आपको हृदय की संरचना का एक आरेख या चित्र दिखाया।", "स्पष्ट, बोली जाने वाली भाषा में आपको समस्या का वर्णन किया।", "आपको स्थिति के बारे में पढ़ने के लिए एक पुस्तिका या पाठ दिया।", "क्या हो रहा है यह दिखाने के लिए हृदय के प्लास्टिक मॉडल का उपयोग किया।"]],
        ["आप अपने दम पर एक नया कंप्यूटर प्रोग्राम उपयोग करना सीख रहे हैं। आप:", ["उपयोगकर्ता पुस्तिका में दिए गए आरेखों का पालन करेंगे।", "उन लोगों से बात करेंगे जो पहले से ही प्रोग्राम का उपयोग करना जानते हैं।", "सॉफ्टवेयर के साथ आने वाले चरण-दर-चरण निर्देशों को पढ़ेंगे।", "यह देखने के लिए कि क्या होता है, सब कुछ क्लिक करके परीक्षण और त्रुटि का उपयोग करेंगे।"]],
        ["वे वेबसाइटें जो आपको सबसे उपयोगी और आकर्षक लगती हैं, उनमें आमतौर पर होता है:", ["मजबूत दृश्य डिजाइन विशेषताएं, रंग और दिलचस्प लेआउट।", "ऑडियो फाइलें, पॉडकास्ट या रिकॉर्ड किए गए साक्षात्कार जिन्हें आप सुन सकते हैं।", "स्पष्ट लिखित विवरण और अच्छी तरह से व्यवस्थित पाठ लेख।", "इंटरैक्टिव तत्व जहां आप चीजों को क्लिक और स्थानांतरित कर सकते हैं।"]],
        ["आप कुछ सीखने के लिए एक नई गैर-फिक्शन किताब खरीद रहे हैं। आप देखते हैं:", ["कई चित्र, चार्ट और एक महान लेआउट वाली किताब।", "एक लंबी चर्चा के बाद किसी मित्र की सिफारिश।", "खरीदने से पहले अंशों और अनुभागों को पढ़ने का मौका।", "चीजों को करने के तरीके के वास्तविक जीवन की कहानियां और व्यावहारिक उदाहरण।"]],
        ["आप बेहतर फोटो लेने का तरीका सीखने के लिए एक किताब का उपयोग कर रहे हैं। आप चाहते हैं कि किताब में हो:", ["कैमरा भागों और प्रकाश स्पेक्ट्रम के विस्तृत आरेख।", "अन्य फोटोग्राफरों के साथ तकनीकों पर चर्चा करने का मौका।", "सेटिंग्स और नियमों की स्पष्ट लिखित सूची और स्पष्टीकरण।", "पेशेवर तस्वीरों के कई उदाहरण और उन्हें कैसे शूट किया गया।"]],
        ["आप पाते हैं कि आप उस शिक्षक से सबसे प्रभावी ढंग से सीखते हैं जो उपयोग करना चुनता है:", ["दृश्य सहायता जैसे चार्ट, ग्राफ और स्लाइड प्रस्तुतियां।", "समूह चर्चा, अतिथि वक्ता और मौखिक स्पष्टीकरण।", "हैंडआउट्स, पाठ्यपुस्तकें और बहुत सारी लिखित पठन सामग्री।", "शारीरिक मॉडल, व्यावहारिक प्रयोग और व्यावहारिक गतिविधियाँ।"]]
    ]},
    mr: { start: "सिस्टम तैयार आहे. स्कॅन सुरू होत आहे.", core: "डेटा कोर ॲक्सेस करा", res_head: "प्रोफाइल विश्लेषण", path: "मार्ग", q: [
        ["तुम्ही कोणालातरी विमानतळ किंवा स्थानिक स्टेशनवर जाण्याचा मार्ग शोधण्यात मदत करत आहात. तुम्ही बहुधा:", ["कागदावर किंवा स्क्रीनवर त्यांना नकाशा दाखवाल.", "त्यांना तोंडी दिशा सांगाल आणि त्यांच्या प्रश्नांची उत्तरे द्याल.", "स्पष्ट पायऱ्यांच्या सूचीच्या रूपात दिशा लिहून द्याल.", "त्यांच्यासोबत जाल आणि त्यांना वैयक्तिकरित्या मार्ग दाखवाल."]],
        ["एका वेबसाइटवर एक जटिल आलेख कसा तयार करायचा हे दर्शविणारा व्हिडिओ आहे. तुम्ही याद्वारे उत्तम शिकता:", ["आकृत्या आणि आलेखाची दृश्य मांडणी पाहून.", "व्हिडिओमधील व्यक्ती प्रक्रिया स्पष्ट करत असताना ऐकून.", "दिलेल्या उपशीर्षके किंवा लेखी सूचना वाचून.", "केल्या जाणाऱ्या शारीरिक कृती आणि पायऱ्या पाहून."]],
        ["तुम्हाला एक महत्त्वाचा प्रकल्प पूर्ण करायचा आहे. त्याचे यश सुनिश्चित करण्यासाठी, तुम्ही याला प्राधान्य द्याल:", ["प्रकल्प संरचना डिझाइन करण्यासाठी आकृत्या आणि तक्त्यांचा वापर करणे.", "तुमच्या कल्पना सुधारण्यासाठी इतरांशी प्रकल्पाच्या तपशीलांवर चर्चा करणे.", "एक तपशीलवार अहवाल किंवा कृतीची संरचित योजना लिहिणे.", "त्याचे मूल्य सिद्ध करण्यासाठी वास्तव जीवनातील उदाहरणे वापरणे."]],
        ["तुम्ही तुमच्या कुटुंबासाठी किंवा मित्रांसाठी काहीतरी खास बनवत आहात. तुम्ही बहुधा:", ["प्रेरणेसाठी कुकबुक किंवा ऑनलाइन चित्रे पाहाल.", "तुमच्या मित्रांकडून सूचना आणि तोंडी टिप्स विचाराल.", "छापील रेसिपी किंवा साहित्याच्या लेखी यादीचे पालन कराल.", "स्मरणशक्तीवरून स्वयंपाक कराल किंवा चाखण्याद्वारे तुमच्या अंतर्ज्ञानाचा वापर कराल."]],
        ["तुम्ही पर्यटकांच्या गटाला स्थानिक वन्यजीव राखीव क्षेत्राबद्दल माहिती देत आहात. तुम्ही:", ["त्यांना प्राणी आणि क्षेत्राचे नकाशे और रंगीत चित्रे दाखवाल.", "त्यांच्याशी उद्यानाचा इतिहास आणि प्राण्यांबद्दल बोलाल.", "त्यांना त्यांच्या गतीने वाचण्यासाठी पुस्तके किंवा ब्रोशर द्याल.", "गोष्टी प्रत्यक्ष पाहण्यासाठी त्यांना राखीव क्षेत्रातून मार्गदर्शित सहलीवर न्याल."]],
        ["तुम्ही नवीन डिजिटल कॅमेरा किंवा मोबाईल फोन खरेदी करण्याची योजना आखत आहात. किंमतीव्यतिरिक्त, तुम्ही पाहता:", ["एक आधुनिक डिझाइन जो दिसायला आकर्षक असेल.", "विक्रेत्याचा सल्ला आणि शिफारसी.", "ऑनलाइन पुनरावलोकने आणि पूर्ण तांत्रिक तपशील वाचणे.", "डिव्हाइस तुमच्या हातात कसे वाटते हे पाहण्यासाठी स्वतः त्याची चाचणी घेणे."]],
        ["काहीतरी नवीन शिकताना, जसे की कॉम्प्युटर प्रोग्राम किंवा छंद, तुम्ही प्राधान्य देता:", ["ते कसे कार्य करते हे दर्शविणाऱ्या आकृत्या आणि तक्त्ये पाहणे.", "तज्ञांकडून ते ऐकणे आणि त्यांना प्रश्न विचारणे.", "लेखी मॅन्युअल किंवा छापील सूचनांचा संच वाचणे.", "प्रात्यक्षिक पाहणे आणि नंतर स्वतः प्रयत्न करणे."]],
        ["डॉक्टर तुम्हाला हृदयाच्या समस्येबद्दल समजावून सांगत आहेत. तुम्हाला उत्तम समजेल जर त्यांनी:", ["तुम्हाला हृदयाच्या संरचनेची आकृती किंवा रेखाचित्र दाखवले.", "स्पष्ट, बोलल्या जाणाऱ्या भाषेत तुम्हाला समस्येचे वर्णन केले.", "तुम्हाला स्थितीबद्दल वाचण्यासाठी एक पुस्तिका किंवा मजकूर दिला.", "काय घडत आहे हे दर्शविण्यासाठी हृदयाच्या प्लास्टिक मॉडेलचा वापर केला."]],
        ["तुम्ही स्वतःहून नवीन कॉम्प्युटर प्रोग्राम वापरायला शिकत आहात. तुम्ही:", ["वापरकर्ता मॅन्युअलमध्ये दिलेल्या आकृत्यांचे पालन कराल.", "ज्यांना आधीच प्रोग्राम वापरणे माहित आहे त्यांच्याशी बोलाल.", "सॉफ्टवेअरसोबत येणाऱ्या टप्प्याटप्प्याने दिलेल्या सूचना वाचाल.", "काय होते हे पाहण्यासाठी सर्वकाही क्लिक करून प्रयत्न कराल."]],
        ["ज्या वेबसाइट्स तुम्हाला सर्वात उपयुक्त आणि आकर्षक वाटतात त्यामध्ये सहसा असतात:", ["मजबूत दृश्य डिझाइन वैशिष्ट्ये, रंग आणि मनोरंजक मांडणी.", "ऑडिओ फाइल्स, पॉडकास्ट किंवा रेकॉर्ड केलेल्या मुलाखती ज्या तुम्ही ऐकू शकता.", "स्पष्ट लेखी वर्णन आणि सुव्यवस्थित लेख.", "परस्परसंवादी घटक जिथे तुम्ही गोष्टी क्लिक करू शकता आणि हलवू शकता."]],
        ["तुम्ही काहीतरी शिकण्यासाठी एक नवीन नॉन-फिक्शन पुस्तक खरेदी करत आहात. तुम्ही पाहता:", ["अनेक चित्रे, तक्ते आणि उत्कृष्ट मांडणी असलेले पुस्तक.", "दीर्घ चर्चेनंतर मित्राने केलेली शिफारस.", "खरेदी करण्यापूर्वी काही भाग वाचण्याची संधी.", "गोष्टी करण्याच्या पद्धतींची वास्तव जीवनातील कथा और व्यावहारिक उदाहरणे."]],
        ["तुम्ही चांगले फोटो कसे घ्यावे हे शिकण्यासाठी पुस्तक वापरत आहात. तुम्हाला पुस्तकात हवे असते:", ["कॅमेरा भाग आणि प्रकाश वर्णपटाच्या तपशीलवार आकृत्या.", "इतर छायाचित्रकारांशी तंत्रांवर चर्चा करण्याची संधी.", "सेटिंग्ज आणि नियमांची स्पष्ट लेखी यादी आणि स्पष्टीकरण.", "व्यावसायिक फोटोंची अनेक उदाहरणे और ते कसे काढले गेले."]],
        ["तुम्हाला असे वाटते की तुम्ही अशा शिक्षकाकडून सर्वात प्रभावीपणे शिकता जो वापरतो:", ["दृश्य साधने जसे की तक्ते, आलेख आणि स्लाइड सादरीकरणे.", "गट चर्चा, पाहुणे वक्ते आणि तोंडी स्पष्टीकरण.", "हँडआउट्स, पाठ्यपुस्तके आणि भरपूर लेखी वाचन साहित्य.", "शारीरिक मॉडल, व्यावहारिक प्रयोग आणि प्रत्यक्ष कृती."]]
    ]}
};

const coachHub = {
    Visual: { 
        en: { title: "VISUAL", meaning: "Focus on charts and graphics.", action: "Use mind maps and diagrams." },
        hi: { title: "दृश्य (Visual)", meaning: "चार्ट और ग्राफिक्स पर ध्यान दें।", action: "माइंड मैप और आरेख का उपयोग करें।" },
        mr: { title: "दृश्य (Visual)", meaning: "तक्ते आणि ग्राफिक्सवर लक्ष केंद्रित करा.", action: "माइंड मॅप्स आणि आकृत्या वापरा." }
    },
    Aural: { 
        en: { title: "AURAL", meaning: "Focus on listening and speaking.", action: "Discuss aloud and record lectures." },
        hi: { title: "श्रवण (Aural)", meaning: "सुनने और बोलने पर ध्यान दें।", action: "जोर से चर्चा करें और लेक्चर रिकॉर्ड करें।" },
        mr: { title: "श्राव्य (Aural)", meaning: "ऐकणे आणि बोलण्यावर लक्ष केंद्रित करा.", action: "मोठ्याने चर्चा करा आणि लेक्चर्स रेकॉर्ड करा." }
    },
    Reading: { 
        en: { title: "READ/WRITE", meaning: "Focus on text and lists.", action: "Use bullet points and summaries." },
        hi: { title: "पठन/लेखन (Read/Write)", meaning: "पाठ और सूचियों पर ध्यान दें।", action: "बुलेट पॉइंट और सारांश का उपयोग करें।" },
        mr: { title: "वाचन/लेखन (Read/Write)", meaning: "मजकूर आणि सूचीवर लक्ष केंद्रित करा.", action: "बुलेट पॉइंट्स आणि सारांश वापरा." }
    },
    Kinesthetic: { 
        en: { title: "KINESTHETIC", meaning: "Focus on physical experience.", action: "Use movement and hands-on practice." },
        hi: { title: "गतिज (Kinesthetic)", meaning: "शारीरिक अनुभव पर ध्यान दें।", action: "आंदोलन और व्यावहारिक अभ्यास का उपयोग करें।" },
        mr: { title: "कायनेटिक (Kinesthetic)", meaning: "शारीरिक अनुभवावर लक्ष केंद्रित करा.", action: "हालचाल आणि प्रत्यक्ष सराव वापरा." }
    }
};

let qIdx = 0, scores = [0,0,0,0], lang = 'en';

function speak(t) { window.speechSynthesis.cancel(); const m = new SpeechSynthesisUtterance(t); m.lang = lang === 'en' ? 'en-US' : (lang === 'hi' ? 'hi-IN' : 'mr-IN'); window.speechSynthesis.speak(m); }
function updateLang() { lang = document.getElementById('lang').value; }

function calibrate() {
    if(!document.getElementById('subjectName').value) return;
    document.getElementById('setup').classList.add('hidden');
    document.getElementById('calibration').classList.remove('hidden');
    speak(content[lang].start);
    setTimeout(() => document.getElementById('cal-bar').style.width = "100%", 100);
    setTimeout(() => { document.getElementById('calibration').classList.add('hidden'); document.getElementById('quiz').classList.remove('hidden'); loadQ(); }, 3000);
}

function loadQ() {
    const q = content[lang].q[qIdx];
    document.getElementById('q-text').innerText = `[${content[lang].path} ${qIdx + 1}/13]: ` + q[0];
    const box = document.getElementById('opts'); box.innerHTML = "";
    document.getElementById('next-btn').disabled = true;
    q[1].forEach((opt, i) => {
        const d = document.createElement('div'); d.className = 'option-node'; d.innerText = opt;
        d.onclick = () => { d.classList.toggle('active'); document.getElementById('next-btn').disabled = document.querySelectorAll('.option-node.active').length === 0; };
        d.dataset.idx = i; box.appendChild(d);
    });
    speak(q[0]);
}

function nextQ() {
    document.querySelectorAll('.option-node.active').forEach(n => scores[parseInt(n.dataset.idx)]++);
    qIdx++; if(qIdx < 13) loadQ(); else showResults();
}

async function syncToCloud(name, scores, topType) {
    try {
        await fetch(DRIVE_LINK, {
            method: 'POST',
            mode: 'no-cors',
            cache: 'no-cache',
            body: JSON.stringify({ name, scores, topType })
        });
        console.log("SYNC SUCCESS: MASTER FILE UPDATED.");
    } catch (e) {
        console.error("SYNC ERROR.", e);
    }
}

function showResults() {
    document.getElementById('quiz').classList.add('hidden');
    document.getElementById('results').classList.remove('hidden');
    document.getElementById('core-label').innerText = content[lang].core;
    
    const types = ["Visual", "Aural", "Reading", "Kinesthetic"];
    const maxScore = Math.max(...scores);
    const winners = types.filter((t, i) => scores[i] === maxScore);
    
    // Straightforward naming logic
    const resultTitle = winners.map(w => coachHub[w][lang].title).join(" / ");
    
    const subjectName = document.getElementById('subjectName').value || "Unknown Asset";
    
    // TRIGGER CLOUD UPLOAD TO SINGLE MASTER FILE
    syncToCloud(subjectName, scores, resultTitle);

    document.getElementById('top-type').innerText = resultTitle;

    let combinedMeaning = "";
    winners.forEach(w => { combinedMeaning += `<p><strong>${coachHub[w][lang].title}:</strong> ${coachHub[w][lang].meaning} <br> ${coachHub[w][lang].action}</p>`; });
    document.getElementById('coach-engine').innerHTML = `<h4>${content[lang].res_head}:</h4>${combinedMeaning}`;

    const total = scores.reduce((a,b)=>a+b,0) || 1;
    document.getElementById('spectrum-bars').innerHTML = "";
    types.forEach((t, i) => {
        const p = Math.round((scores[i]/total)*100);
        // Direct Label mapping
        const label = t === "Reading" ? "Read/Write" : t;
        document.getElementById('spectrum-bars').innerHTML += `<div style="font-size:10px; text-align:left;">${label}: ${p}%</div><div class="spec-bg"><div class="spec-fill" style="width:${p}%"></div></div>`;
    });
    speak(resultTitle);
}

function exportToExcel() {
    const name = document.getElementById('subjectName').value || "Asset";
    const headerKey = lang === 'en' ? "REPORT" : (lang === 'hi' ? "रिपोर्ट" : "अहवाल");
    const data = [{ [headerKey]: (lang === 'en' ? "Name" : "नाम"), "Value": name }];
    ["Visual", "Aural", "Read/Write", "Kinesthetic"].forEach((t, i) => { data.push({ [headerKey]: t, "Value": scores[i] }); });
    const ws = XLSX.utils.json_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Neural_Report");
    XLSX.writeFile(wb, `OSIRIS_DATA_${name}.xlsx`);
}

function copyNeuralLink() {
    const name = document.getElementById('subjectName').value || "Asset";
    const types = ["Visual", "Aural", "Read/Write", "Kinesthetic"];
    const total = scores.reduce((a,b)=>a+b,0) || 1;
    let scoreBreakdown = "";
    types.forEach((t, i) => { scoreBreakdown += `${t}: ${Math.round((scores[i]/total)*100)}%, `; });

    const masterPrompt = `SYSTEM ACTIVATE: MACHINE. Subject: ${name}. Results: ${scoreBreakdown}. Language: ${lang.toUpperCase()}. Instruction: Analyze learning profile and give 3 hacks to study faster.`;

    if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(masterPrompt).then(() => {
            alert("NEURAL LINK ESTABLISHED.");
        }).catch(err => {
            fallbackCopy(masterPrompt);
        });
    } else {
        fallbackCopy(masterPrompt);
    }
}

function fallbackCopy(text) {
    const textArea = document.createElement("textarea");
    textArea.value = text;
    textArea.style.position = "fixed";
    textArea.style.left = "-9999px";
    textArea.style.top = "0";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    textArea.setSelectionRange(0, 99999);
    try {
        document.execCommand('copy');
        alert("NEURAL LINK ESTABLISHED.");
    } catch (err) {
        alert("LINK FAILED. PLEASE COPY MANUALLY.");
    }
    document.body.removeChild(textArea);
}
</script>
</body>
</html>